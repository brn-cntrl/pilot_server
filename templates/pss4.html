<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSS-4 Survey</title>
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="testModule">
        <h1>Perceived Stress Scale (PSS-4)</h1>
        <form action="submit_pss4" id='pss4Form'>
            <h3>In the last month, how often have you felt that you were unable to control the important things in your life?</h3>
            <label>
                <input type="radio" name="controlFeeling1" value="Never"> Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling1" value="Almost Never"> Almost Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling1" value="Sometimes"> Sometimes
            </label><br>
            <label>
                <input type="radio" name="controlFeeling1" value="Fairly Often"> Fairly Often
            </label><br>
            <label>
                <input type="radio" name="controlFeeling1" value="Often"> Often
            </label><br>
            <label>
                <input type="radio" name="controlFeeling1" id="otherOption" value="Other" onclick="handleOtherOption()"> Other
            </label><br>
            <div id="otherTextbox" style="display: none;">
                <label>Please specify: <input type="text" id="otherText" name="otherText"></label>
            </div><br><br>

            <h3>In the last month, how often have you felt confident about your ability to handle your personal problems?</h3>
            <label>
                <input type="radio" name="controlFeeling2" value="Never"> Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling2" value="Almost Never"> Almost Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling2" value="Sometimes"> Sometimes
            </label><br>
            <label>
                <input type="radio" name="controlFeeling2" value="Fairly Often"> Fairly Often
            </label><br>
            <label>
                <input type="radio" name="controlFeeling2" value="Often"> Often
            </label><br><br>

            <h3>In the last month, how often have you felt that things were going your way?</h3>
            <label></label>
                <input type="radio" name="controlFeeling3" value="Never"> Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling3" value="Almost Never"> Almost Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling3" value="Sometimes"> Sometimes
            </label><br>
            <label>
                <input type="radio" name="controlFeeling3" value="Fairly Often"> Fairly Often
            </label><br>
            <label>
                <input type="radio" name="controlFeeling3" value="Often"> Often
            </label><br><br>

            <h3>In the last month, how often have you felt difficulties were piling up so high that you could not overcome them?</h3>
            <label></label>
                <input type="radio" name="controlFeeling4" value="Never"> Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling4" value="Almost Never"> Almost Never
            </label><br>
            <label>
                <input type="radio" name="controlFeeling4" value="Sometimes"> Sometimes
            </label><br>
            <label>
                <input type="radio" name="controlFeeling4" value="Fairly Often"> Fairly Often
            </label><br>
            <label>
                <input type="radio" name="controlFeeling4" value="Often"> Often
            </label><br><br>
            <input type="submit" value="Submit"><br><br>
        </form>
        <div id="notification" style="display:none; color: green;">Form submitted successfully!</div>
        <div id="errorNotification" style="display:none; color: red;">Error submitting form.</div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('pss4Form');
            form.addEventListener('submit', function(event) {
                event.preventDefault(); 

                const formData = new FormData(form); 

                fetch('/submit_pss4', { 
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log(data); 
                    document.getElementById('notification').style.display = 'block';
                    document.getElementById('errorNotification').style.display = 'none';
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('notification').style.display = 'none';
                    document.getElementById('errorNotification').style.display = 'block';
                });
            });
        });
        
        function handleOtherOption() {
            const otherOption = document.getElementById('otherOption');
            const otherText = document.getElementById('otherTextbox');

            // Check if the "Other" option is selected
            if (otherOption.checked) {
                otherText.style.display = 'block'; // Show the text box
            } else {
                otherText.style.display = 'none';  // Hide the text box
            }
        }
    </script>
</body>
</html>